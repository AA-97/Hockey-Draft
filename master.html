<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fantasy Hockey Draft Tracker - ADMIN DASHBOARD</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f7f9fb; }
    .custom-scrollbar::-webkit-scrollbar { width: 8px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #a0aec0; border-radius: 4px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #edf2f7; }
    #custom-modal-backdrop { z-index: 50; }
    .loading-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(255, 255, 255, 0.95); display: flex; justify-content: center;
        align-items: center; z-index: 100; flex-direction: column;
    }
    .admin-lock {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(248, 113, 113, 0.95); /* Red-400 equivalent */
        display: none; justify-content: center; align-items: center; z-index: 200;
        color: white; text-align: center;
    }
  </style>
  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // --- GLOBAL STATE & FIREBASE SETUP ---
    let db = null;
    let auth = null;
    let currentUserId = null;
    window.users = [];

    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

    // Firestore Paths
    const USERS_COLLECTION_PATH = `/artifacts/${appId}/public/data/fantasy_users`;
    const ADMIN_DOC_PATH = `/artifacts/${appId}/public/data/admin/master`;

    /** * Admin check: Ensures only the first authenticated user can access the admin panel.
     */
    async function checkAdminAccess() {
        const adminDocRef = doc(db, ADMIN_DOC_PATH);
        const adminSnap = await getDoc(adminDocRef);

        let masterAdminId = null;

        if (adminSnap.exists()) {
            masterAdminId = adminSnap.data().userId;
            console.log("Master Admin ID found:", masterAdminId);
        } else {
            // If no admin is registered, register the current user as the admin
            await setDoc(adminDocRef, { userId: currentUserId, setTime: Date.now() });
            masterAdminId = currentUserId;
            console.log("Current user registered as Master Admin.");
        }

        if (currentUserId === masterAdminId) {
            document.getElementById('loading-overlay').style.display = 'none';
            document.getElementById('admin-welcome').textContent = "Welcome, Master Admin!";
            listenForUserData();
            return true;
        } else {
            // LOCK THE PAGE
            document.getElementById('loading-overlay').style.display = 'none';
            const lockDiv = document.getElementById('admin-lock-screen');
            lockDiv.style.display = 'flex';
            document.getElementById('admin-message').textContent = `Access Denied. Only the Master Admin (ID: ${masterAdminId}) can view this page.`;
            return false;
        }
    }

    async function saveUsersToDatabase(newUsers) {
        if (!db || !currentUserId) return; // Prevent saving if not authenticated/initialized

        // Check if current user is the master admin before saving
        const adminDocRef = doc(db, ADMIN_DOC_PATH);
        const adminSnap = await getDoc(adminDocRef);
        if (adminSnap.exists() && adminSnap.data().userId !== currentUserId) {
             showModal('Security Warning', 'You are not the Master Admin and cannot modify data.', false);
             return;
        }

        try {
            const docRef = doc(db, USERS_COLLECTION_PATH, 'data');
            await setDoc(docRef, { users: newUsers }, { merge: false });
            console.log("Admin Data successfully saved to Firestore.");
        } catch (e) {
            console.error("Error writing document: ", e);
            showModal('Error', 'Failed to save data to the server. Check console for details.');
        }
    }
    window.saveUsersToDatabase = saveUsersToDatabase;

    // Real-time listener function
    function listenForUserData() {
        if (!db) return;

        const docRef = doc(db, USERS_COLLECTION_PATH, 'data');

        onSnapshot(docRef, (docSnap) => {
            if (docSnap.exists()) {
                const data = docSnap.data();
                window.users = data.users || [];
                console.log("Data successfully loaded/updated from Firestore:", window.users);
            } else {
                console.log("No initial data found. Initializing empty roster.");
                window.users = [];
            }

            // Re-render all parts of the UI with the newly synchronized data
            window.updateUserSelect();
            window.updateDraftList();
            window.calculatePointsAndRankings();
        }, (error) => {
            console.error("Error listening to document: ", error);
            showModal('Database Error', 'Lost connection to real-time database. Please check your network connection.');
        });
    }

    // Initialization function
    async function initializeApp() {
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            setLogLevel('Debug');

            const loadingOverlay = document.getElementById('loading-overlay');

            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth);
            }

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    currentUserId = user.uid;
                    document.getElementById('user-id-display').textContent = `Your User ID: ${currentUserId}`;
                    await checkAdminAccess();
                } else {
                    currentUserId = null;
                    document.getElementById('user-id-display').textContent = 'User Not Authenticated.';
                    loadingOverlay.style.display = 'none';
                    document.getElementById('admin-lock-screen').style.display = 'flex';
                    document.getElementById('admin-message').textContent = 'Authentication Failed. Cannot proceed.';
                }
            });

        } catch (error) {
            console.error("Firebase initialization or authentication failed:", error);
            showModal('Initialization Error', 'Could not connect to the database. See console for details.');
            document.getElementById('loading-overlay').style.display = 'none';
        }
    }

    window.onload = initializeApp;
  </script>
  <script>
    // Use an IIFE for application logic
    (function() {
        window.users = window.users || [];
        const generateUniqueId = () => crypto.randomUUID();

        // --- Custom Modal/Alert Implementation ---
        let resolveModal = null;
        function showModal(title, message, isConfirmation = false) {
            const modal = document.getElementById('custom-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');
            const modalConfirmButton = document.getElementById('modal-confirm-button');
            const modalCancelButton = document.getElementById('modal-cancel-button');
            modalTitle.textContent = title;
            modalMessage.textContent = message;

            if (isConfirmation) {
                modalConfirmButton.classList.remove('hidden');
                modalCancelButton.classList.remove('hidden');
                modalConfirmButton.focus();
            } else {
                modalConfirmButton.classList.add('hidden');
                modalCancelButton.classList.add('hidden');
            }
            modal.classList.remove('hidden');

            return new Promise(resolve => { resolveModal = resolve; });
        }
        window.showModal = showModal;

        document.addEventListener('DOMContentLoaded', () => {
            const modalConfirmButton = document.getElementById('modal-confirm-button');
            const modalCancelButton = document.getElementById('modal-cancel-button');
            const modalCloseButton = document.getElementById('modal-close-button');

            const handleConfirm = () => { document.getElementById('custom-modal').classList.add('hidden'); if (resolveModal) resolveModal(true); };
            const handleCancel = () => { document.getElementById('custom-modal').classList.add('hidden'); if (resolveModal) resolveModal(false); };
            const handleClose = () => {
                document.getElementById('custom-modal').classList.add('hidden');
                if (resolveModal && document.getElementById('modal-confirm-button').classList.contains('hidden') === false) { resolveModal(false); }
            };

            modalConfirmButton.addEventListener('click', handleConfirm);
            modalCancelButton.addEventListener('click', handleCancel);
            modalCloseButton.addEventListener('click', handleClose);
            document.getElementById('custom-modal-backdrop').addEventListener('click', handleClose);
        });

        // --- UI Element Initialization (Simplified for Admin view) ---
        let draftList, rankingsTableBody, individualRankingsTableBody, individualRankingsDisplay, userSelect, teamPointsDisplay, draftUserSelect;

        document.addEventListener('DOMContentLoaded', () => {
            draftList = document.getElementById('draft-list');
            rankingsTableBody = document.getElementById('rankings-table-body');
            individualRankingsTableBody = document.getElementById('individual-rankings-table-body');
            individualRankingsDisplay = document.getElementById('individual-rankings-display');
            userSelect = document.getElementById('user-select');
            teamPointsDisplay = document.getElementById('team-points-display');
            draftUserSelect = document.getElementById('draft-user-select');

            document.getElementById('add-user-button').addEventListener('click', () => { document.getElementById('add-user-form').classList.toggle('hidden'); });
            document.getElementById('add-user-submit').addEventListener('click', handleAddUser);
            document.getElementById('remove-user-button').addEventListener('click', handleRemoveUser);
            document.getElementById('add-player-button').addEventListener('click', handleAddPlayer);
            document.getElementById('show-individual-rankings-button').addEventListener('click', handleShowIndividualRankings);
            document.getElementById('close-individual-rankings-button').addEventListener('click', () => { individualRankingsDisplay.classList.add('hidden'); });

            if (!draftList || !rankingsTableBody) { console.error("Critical DOM elements not found."); }
        });

        // --- Core Logic Functions (Unchanged) ---
        function calculatePointsAndRankings() {
            window.users.forEach(user => {
                user.totalPoints = user.roster.reduce((sum, player) => sum + (player.points || 0), 0);
                user.individualPlayerScores = user.roster.map(p => ({
                    name: p.name, points: p.points || 0, position: p.position
                })).sort((a, b) => b.points - a.points);
            });
            const allPlayers = window.users.flatMap(user => user.roster.map(player => ({ ...player, userId: user.id })));
            allPlayers.sort((a, b) => (b.points || 0) - (a.points || 0));
            allPlayers.forEach((player, index) => { player.overallRank = index + 1; });
            window.users.forEach(user => {
                user.roster.forEach(player => {
                    const rankedPlayer = allPlayers.find(p => p.id === player.id);
                    if (rankedPlayer) { player.overallRank = rankedPlayer.overallRank; }
                });
            });
            window.users.sort((a, b) => b.totalPoints - a.totalPoints);
            updateRankingsTable();
            updateTeamPointsDisplay();
        }
        window.calculatePointsAndRankings = calculatePointsAndRankings;

        function updateRankingsTable() {
            if (!rankingsTableBody) return;
            rankingsTableBody.innerHTML = window.users.length === 0
                ? '<tr><td colspan="4" class="text-center py-4 text-gray-500">No users added yet.</td></tr>'
                : window.users.map((user, index) => {
                    const rankClass = index === 0 ? 'bg-yellow-100 font-bold' : (index === 1 ? 'bg-gray-200' : '');
                    return `<tr class="border-b hover:bg-gray-50 ${rankClass}">
                        <td class="px-4 py-2 text-center rounded-l-lg">${index + 1}</td>
                        <td class="px-4 py-2">${user.teamName}</td>
                        <td class="px-4 py-2 text-center">${user.roster.length}</td>
                        <td class="px-4 py-2 text-center font-semibold rounded-r-lg">${user.totalPoints.toFixed(0)}</td>
                    </tr>`;
                }).join('');
        }

        function updateTeamPointsDisplay() {
            if (!teamPointsDisplay) return;
            teamPointsDisplay.innerHTML = window.users.length === 0
                ? '<p class="text-gray-500">No teams to display points for.</p>'
                : window.users.map(user =>
                    `<div class="bg-white p-4 rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition">
                        <h3 class="text-xl font-bold text-blue-600 mb-2">${user.teamName}</h3>
                        <p class="text-3xl font-extrabold text-green-700">${user.totalPoints.toFixed(0)}</p>
                        <p class="text-sm text-gray-500">Total Points</p>
                    </div>`
                ).join('');
        }

        function updateDraftList() {
            if (!draftList) return;
            const allPlayers = window.users.flatMap(user => user.roster.map(player => ({
                ...player, userName: user.teamName, userId: user.id
            })));

            if (allPlayers.length === 0) {
                 draftList.innerHTML = '<p class="text-center py-4 text-gray-500">No players drafted yet.</p>';
                 return;
            }
            allPlayers.sort((a, b) => (a.overallRank || Infinity) - (b.overallRank || Infinity));

            draftList.innerHTML = allPlayers.map(player =>
                `<li class="flex justify-between items-center p-3 border-b border-gray-200 hover:bg-gray-50 transition">
                    <div class="flex-grow">
                        <span class="font-bold text-lg text-gray-800">#${player.overallRank}</span>
                        <span class="ml-4 font-semibold text-blue-800">${player.name}</span>
                        <span class="ml-2 text-sm text-gray-500">(${player.position})</span>
                    </div>
                    <div class="text-right">
                        <span class="block text-sm text-gray-600">${player.userName}</span>
                        <span class="block text-md font-bold text-green-600">${player.points} Points</span>
                    </div>
                </li>`
            ).join('');
        }
        window.updateDraftList = updateDraftList;

        function updateUserSelect() {
            if (!userSelect || !draftUserSelect) return;

            const optionsHtml = window.users.map(user =>
                `<option value="${user.id}">${user.teamName}</option>`
            ).join('');

            userSelect.innerHTML = '<option value="">Select User...</option>' + optionsHtml;
            draftUserSelect.innerHTML = '<option value="">Select User...</option>' + optionsHtml;
        }
        window.updateUserSelect = updateUserSelect;


        // --- Event Handlers (Using teamName instead of first/last name) ---

        async function handleAddUser() {
            const teamName = document.getElementById('team-name-input').value.trim();

            if (!teamName) { showModal('Input Error', 'Please enter a Team Name.'); return; }
            if (window.users.some(u => u.teamName.toLowerCase() === teamName.toLowerCase())) {
                showModal('Input Error', `The team name "${teamName}" already exists.`);
                return;
            }

            const newUser = {
                id: generateUniqueId(),
                teamName: teamName,
                roster: [], totalPoints: 0, individualPlayerScores: []
            };

            const newUsers = [...window.users, newUser];
            await saveUsersToDatabase(newUsers);

            document.getElementById('team-name-input').value = '';
            document.getElementById('add-user-form').classList.add('hidden');
            showModal('Success', `${teamName} has been added and saved to the cloud.`);
        }

        async function handleRemoveUser() {
            const selectedUserId = userSelect.value;
            if (!selectedUserId) { showModal('Selection Error', 'Please select a user to remove.'); return; }

            const userToRemove = window.users.find(user => String(user.id) === selectedUserId);
            if (!userToRemove) { showModal('Error', 'User not found in the roster.'); return; }

            const confirmation = await showModal(
                'Confirm Removal',
                `Are you sure you want to remove team ${userToRemove.teamName} and all their drafted players? This action is permanent.`,
                true
            );

            if (!confirmation) { return; }

            const newUsers = window.users.filter(user => String(user.id) !== selectedUserId);
            await saveUsersToDatabase(newUsers);

            showModal('Success', `Team ${userToRemove.teamName} has been removed.`);
        }

        async function handleAddPlayer() {
            const userId = draftUserSelect.value;
            const playerName = document.getElementById('player-name-input').value.trim();
            const playerPoints = parseInt(document.getElementById('player-points-input').value.trim());
            const playerPosition = document.getElementById('player-position-input').value.trim();

            if (!userId || !playerName || isNaN(playerPoints) || !playerPosition) {
                showModal('Input Error', 'Please select a user and enter valid player details (Name, Points, Position).');
                return;
            }

            const targetUser = window.users.find(user => String(user.id) === userId);

            if (!targetUser) { showModal('Error', 'Selected user not found.'); return; }

            const newPlayer = {
                id: generateUniqueId(), name: playerName, points: playerPoints, position: playerPosition, overallRank: 0
            };

            const newUsers = window.users.map(user => {
                if (String(user.id) === userId) {
                    return { ...user, roster: [...user.roster, newPlayer] };
                }
                return user;
            });

            await saveUsersToDatabase(newUsers);

            document.getElementById('player-name-input').value = '';
            document.getElementById('player-points-input').value = '';
            document.getElementById('player-position-input').value = '';

            showModal('Success', `${playerName} (${playerPoints} Pts) added to ${targetUser.teamName}'s roster.`);
        }

        function handleShowIndividualRankings() {
            if (!individualRankingsDisplay || !individualRankingsTableBody) return;

            const selectedUserId = userSelect.value;
            if (!selectedUserId) {
                showModal('Selection Error', 'Please select a user from the "Remove User" dropdown to view their individual player rankings.');
                return;
            }

            const user = window.users.find(u => String(u.id) === selectedUserId);
            if (!user) { showModal('Error', 'User not found.'); return; }

            individualRankingsDisplay.querySelector('h2').textContent = `${user.teamName}'s Roster Rankings`;
            individualRankingsTableBody.innerHTML = user.individualPlayerScores.length === 0
                ? '<tr><td colspan="3" class="text-center py-4 text-gray-500">This user has no players drafted.</td></tr>'
                : user.individualPlayerScores.map((player, index) =>
                    `<tr class="border-b hover:bg-gray-50">
                        <td class="px-4 py-2 text-center rounded-l-lg">${index + 1}</td>
                        <td class="px-4 py-2 font-medium">${player.name} (${player.position})</td>
                        <td class="px-4 py-2 text-center font-semibold rounded-r-lg">${player.points}</td>
                    </tr>`
                ).join('');

            individualRankingsDisplay.classList.remove('hidden');
        }

    })(); // End IIFE
  </script>
</head>
<body class="p-4 md:p-8 bg-gray-50">
<!-- Admin Lock Screen (Hidden by default) -->
<div id="admin-lock-screen" class="admin-lock">
  <div class="p-8 bg-white rounded-xl shadow-2xl text-red-700">
    <h1 class="text-5xl font-extrabold mb-4">ACCESS DENIED</h1>
    <p id="admin-message" class="text-lg"></p>
    <p class="mt-4 text-gray-600">Please use the <a href="index.html" class="underline font-bold text-red-500 hover:text-red-700">public entry page</a> to submit a roster.</p>
  </div>
</div>

<!-- Loading Overlay -->
<div id="loading-overlay" class="loading-overlay">
  <div class="text-center">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
    <p class="mt-4 text-lg text-blue-600 font-semibold">Authenticating Admin...</p>
  </div>
</div>

<!-- Custom Modal Structure -->
<div id="custom-modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 hidden" onclick="document.getElementById('custom-modal').classList.add('hidden')"></div>
<div id="custom-modal" class="fixed inset-0 flex items-center justify-center p-4 hidden">
  <div class="bg-white rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <!-- Modal Header -->
    <div class="flex justify-between items-center p-5 border-b border-gray-200">
      <h3 id="modal-title" class="text-xl font-bold text-gray-900">Modal Title</h3>
      <button id="modal-close-button" class="text-gray-400 hover:text-gray-600 transition">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
      </button>
    </div>
    <!-- Modal Body -->
    <div class="p-5">
      <p id="modal-message" class="text-gray-700"></p>
    </div>
    <!-- Modal Footer -->
    <div class="p-5 border-t border-gray-200 flex justify-end space-x-3">
      <button id="modal-cancel-button" class="hidden px-4 py-2 text-sm font-semibold text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition focus:outline-none">
        Cancel
      </button>
      <button id="modal-confirm-button" class="hidden px-4 py-2 text-sm font-semibold text-white bg-red-600 rounded-lg hover:bg-red-700 transition focus:outline-none">
        Confirm
      </button>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="max-w-7xl mx-auto">
  <header class="text-center mb-8 p-4 bg-white rounded-xl shadow-lg">
    <h1 class="text-4xl font-extrabold text-red-700">ADMIN: Full Draft Management</h1>
    <p id="admin-welcome" class="text-xl font-semibold text-red-500 mt-1">Authenticating...</p>
    <p class="text-gray-500 mt-2">Manage all teams and players in real-time.</p>
    <p id="user-id-display" class="text-xs mt-2 text-gray-400"></p>
  </header>

  <!-- Main Grid Layout (Hidden until Admin Check passes) -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

    <!-- Column 1: Management and Draft Area (Input) -->
    <div class="lg:col-span-1 space-y-8">

      <!-- User Management Panel -->
      <div class="p-6 bg-white rounded-xl shadow-lg border border-blue-100">
        <h2 class="text-2xl font-bold text-blue-600 mb-4">Team Management</h2>

        <button id="add-user-button" class="w-full bg-green-500 text-white p-3 rounded-lg font-semibold hover:bg-green-600 transition mb-3 shadow-md">
          + Add New Team
        </button>

        <!-- Add User Form -->
        <div id="add-user-form" class="hidden bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
          <input type="text" id="team-name-input" placeholder="Team Name (e.g., Connor's Crew)" class="w-full p-2 mb-3 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
          <button id="add-user-submit" class="w-full bg-blue-500 text-white p-2 rounded-lg font-semibold hover:bg-blue-600 transition">
            Save Team to Cloud
          </button>
        </div>

        <div class="mt-4">
          <label for="user-select" class="block text-sm font-medium text-gray-700 mb-2">Select Team for Removal/Roster View</label>
          <select id="user-select" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
            <option value="">Select User...</option>
          </select>
          <div class="flex space-x-2 mt-3">
            <button id="remove-user-button" class="flex-1 bg-red-500 text-white p-3 rounded-lg font-semibold hover:bg-red-600 transition shadow-md">
              Remove Team
            </button>
            <button id="show-individual-rankings-button" class="flex-1 bg-purple-500 text-white p-3 rounded-lg font-semibold hover:bg-purple-600 transition shadow-md">
              View Roster
            </button>
          </div>
        </div>
      </div>

      <!-- Draft Player Area -->
      <div class="p-6 bg-white rounded-xl shadow-lg border border-green-100">
        <h2 class="text-2xl font-bold text-green-600 mb-4">Draft Player</h2>

        <label for="draft-user-select" class="block text-sm font-medium text-gray-700 mb-2">Assign to Team</label>
        <select id="draft-user-select" class="w-full p-2 mb-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500">
          <option value="">Select User...</option>
        </select>

        <input type="text" id="player-name-input" placeholder="Player Name" class="w-full p-2 mb-2 border rounded-lg focus:ring-green-500 focus:border-green-500">
        <input type="number" id="player-points-input" placeholder="Total Points (e.g., 85)" class="w-full p-2 mb-2 border rounded-lg focus:ring-green-500 focus:border-green-500">
        <input type="text" id="player-position-input" placeholder="Position (e.g., C, RW, D)" class="w-full p-2 mb-3 border rounded-lg focus:ring-green-500 focus:border-green-500">

        <button id="add-player-button" class="w-full bg-green-500 text-white p-3 rounded-lg font-semibold hover:bg-green-600 transition shadow-md">
          Add Player to Roster
        </button>
      </div>
    </div>

    <!-- Column 2: Rankings and Points -->
    <div class="lg:col-span-2 space-y-8">

      <!-- Team Total Points Display -->
      <div class="p-6 bg-white rounded-xl shadow-lg border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-700 mb-4">Team Total Points</h2>
        <div id="team-points-display" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4">
          <!-- Points cards will be inserted here -->
        </div>
      </div>

      <!-- Overall Rankings Panel -->
      <div class="p-6 bg-white rounded-xl shadow-lg border border-yellow-200">
        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Overall Team Rankings</h2>
        <div class="overflow-x-auto custom-scrollbar">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
            <tr class="bg-gray-100 text-gray-600 text-sm leading-normal">
              <th class="py-3 px-4 text-center">Rank</th>
              <th class="py-3 px-4 text-left">Team Name</th>
              <th class="py-3 px-4 text-center">Players</th>
              <th class="py-3 px-4 text-center">Total Points</th>
            </tr>
            </thead>
            <tbody id="rankings-table-body" class="text-gray-600 text-sm font-light divide-y divide-gray-200">
            <!-- Rankings rows will be inserted here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Column 3 (Draft List, moved to full width bottom for better view on desktop) -->
    <div class="lg:col-span-3">
      <div class="p-6 bg-white rounded-xl shadow-lg border border-blue-200">
        <h2 class="text-2xl font-bold text-blue-600 mb-4">Overall Draft List (Ranked by Points)</h2>
        <div class="h-96 overflow-y-auto custom-scrollbar">
          <ul id="draft-list" class="divide-y divide-gray-100">
            <!-- Drafted players will be listed here -->
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Individual Rankings Modal Display (Hidden by default) -->
  <div id="individual-rankings-display" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg">
      <div class="p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold text-blue-600">Roster Rankings</h2>
          <button id="close-individual-rankings-button" class="text-gray-400 hover:text-gray-600 transition">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
          </button>
        </div>
        <div class="overflow-y-auto max-h-96 custom-scrollbar">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
            <tr class="bg-gray-100 text-gray-600 text-sm leading-normal">
              <th class="py-3 px-4 text-center">Rank</th>
              <th class="py-3 px-4 text-left">Player Name (Position)</th>
              <th class="py-3 px-4 text-center">Points</th>
            </tr>
            </thead>
            <tbody id="individual-rankings-table-body" class="text-gray-600 text-sm font-light divide-y divide-gray-200">
            <!-- Individual player rankings inserted here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</div>
</body>
</html>
